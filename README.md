# CV

Для решения задачи идентификации логотипа на изображении или видео с учетом возможных искажений, изменений масштаба, яркости, контрастности и других факторов, была составлена следующая система:

#### Общая идея
Система должна решать задачу поиска логотипа на изображении, сравнивая его с несколькими образцами. Основные этапы:
1. **Детекция логотипов** на изображении с помощью модели YOLO.
2. **Извлечение признаков** из детектированных логотипов и образцов с использованием предобученной CNN (ResNet50).
3. **Сравнение признаков** с помощью косинусного сходства для определения, является ли детектированный логотип искомым.

---

### 1. Детекция логотипов (YOLO)
YOLO (You Only Look Once) — это сверточная нейронная сеть (CNN), которая выполняет детекцию объектов на изображении. Она предсказывает bounding box (ограничивающие рамки) и классы объектов.

#### Операции с данными внутри модели:
- **Входные данные**: Изображение в формате 3D-тензора (высота × ширина × каналы, где каналы — это RGB).
- **Выходные данные**: Координаты bounding box (x_min, y_min, x_max, y_max) и классы объектов.
- **Процесс**:
  - Изображение проходит через несколько сверточных слоев, где применяются операции свертки (convolution) и пулинга (pooling).
  - На выходе получается тензор, содержащий информацию о bounding box и классах объектов.
  - Используется функция потерь (например, MSE для координат и cross-entropy для классов), чтобы обучить модель предсказывать правильные bounding box и классы.

---

### 2. Извлечение признаков (ResNet50)
ResNet50 — это предобученная CNN, которая используется для извлечения признаков из изображений. Она состоит из 50 слоев, включая сверточные слои, слои пулинга и residual connections (пропускные соединения).

#### Операции с данными внутри модели:
- **Входные данные**: Изображение, преобразованное в тензор размером 224×224×3 (после предобработки).
- **Выходные данные**: Вектор признаков размером 2048 (последний слой перед fully connected слоем).
- **Процесс**:
  - Изображение проходит через несколько сверточных блоков, где применяются операции свертки, активации (ReLU) и пулинга.
  - На выходе получается тензор, который затем усредняется (global average pooling), чтобы получить вектор признаков.
  - Вектор признаков представляет собой компактное числовое представление изображения, которое сохраняет его ключевые характеристики.

---

### 3. Сравнение признаков (косинусное сходство)
Косинусное сходство используется для сравнения двух векторов признаков. Оно измеряет угол между векторами в многомерном пространстве.

- **Интерпретация**:
  - Значение близкое к 1: векторы очень похожи.
  - Значение близкое к 0: векторы ортогональны (не похожи).
  - Значение близкое к -1: векторы противоположны.

---

### 4. Обучение модели (fine-tuning)
Если необходимо дообучить модель на новых данных, используется метод fine-tuning. В этом случае:
- Замораживаются все слои, кроме последнего fully connected слоя.
- Обучается только последний слой на новых данных.

#### Математика:
- **Функция потерь**: Binary Cross-Entropy Loss (BCEWithLogitsLoss), которая используется для бинарной классификации.

- **Оптимизация**: Используется метод Adam для обновления весов модели.

---

### 5. Работа с датасетом (LogoDet-3K)
Датасет LogoDet-3K содержит изображения логотипов и их аннотации. Для работы с ним:
- Изображения предобрабатываются (изменение размера, нормализация).
- Аннотации преобразуются из формата VOC (XML) в формат YOLO (текстовые файлы с координатами bounding box).

---

### Пример работы системы
1. **Детекция**: На вход подается изображение с рекламой. YOLO находит все возможные логотипы и возвращает их bounding box.
2. **Извлечение признаков**: Каждый детектированный логотип и образец преобразуются в вектор признаков с помощью ResNet50.
3. **Сравнение**: Для каждого детектированного логотипа вычисляется косинусное сходство с образцом.
4. **Результат**: Если сходство превышает порог, логотип считается искомым.


---

### Пример использования
1. **Вход**: Изображение с рекламой и несколько образцов логотипов.
2. **Выход**: **Система выводит результат** в виде бинарного ответа: "Да" (логотип принадлежит искомой организации) или "Нет" (логотип не принадлежит).



