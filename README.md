# CV

Для решения задачи идентификации логотипа на изображении или видео с учетом возможных искажений, изменений масштаба, яркости, контрастности и других факторов, была составлена следующая система:

### Общий обзор процесса

В данном коде реализован процесс обнаружения логотипов на изображениях, извлечения их признаков с использованием сверточной нейронной сети (CNN), сравнения этих признаков с образцом и дообучения модели на новых данных. Основные этапы включают:

1. **Детекция логотипов** с использованием модели YOLOv8.
2. **Извлечение признаков** из обнаруженных логотипов с помощью предобученной модели ResNet50.
3. **Сравнение признаков** с использованием косинусного сходства.
4. **Дообучение модели** на новых данных для улучшения классификации.

### Математические аспекты и преобразования данных

#### 1. Детекция логотипов с использованием YOLOv8

YOLO (You Only Look Once) — это модель для обнаружения объектов, которая предсказывает bounding box (ограничивающие рамки) и классы объектов на изображении. В данном случае YOLO используется для обнаружения логотипов.

- **Входные данные**: Изображение в формате RGB (3 канала).
- **Выходные данные**: Координаты bounding box (x_min, y_min, x_max, y_max) для каждого обнаруженного логотипа.

YOLO работает следующим образом:
- Изображение делится на сетку, и для каждой ячейки сетки предсказываются bounding box, класс объекта и вероятность принадлежности к этому классу.
- Используется функция потерь, которая учитывает ошибки в предсказании координат, классов и наличия объекта.

#### 2. Извлечение признаков с использованием ResNet50

ResNet50 — это сверточная нейронная сеть, которая используется для извлечения признаков из изображений. В данном случае последний слой (fully connected) удаляется, чтобы получить вектор признаков, а не классификацию.

- **Входные данные**: Изображение логотипа, обрезанное по bounding box, преобразованное в размер 224x224 и нормализованное.
- **Выходные данные**: Вектор признаков размерности 2048 (последний слой перед fully connected в ResNet50).

Преобразования изображения перед подачей в ResNet50:
1. **Resize**: Изображение изменяется до размера 224x224.
2. **ToTensor**: Преобразование изображения в тензор (массив чисел) и нормализация значений пикселей в диапазон [0, 1].
3. **Normalize**: Нормализация значений пикселей с использованием среднего и стандартного отклонения (mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225]).

Математически ResNet50 состоит из множества сверточных слоев, которые применяют фильтры к изображению, извлекая признаки разного уровня абстракции. В конце сети используется глобальный average pooling, который преобразует карты признаков в вектор.

#### 3. Сравнение признаков с использованием косинусного сходства

Косинусное сходство — это мера, которая показывает, насколько два вектора похожи друг на друга. Она вычисляется как косинус угла между двумя векторами.

- **Входные данные**: Два вектора признаков (например, признаки извлеченные из обнаруженного логотипа и образца).
- **Выходные данные**: Значение косинусного сходства в диапазоне от -1 до 1, где 1 означает полное сходство, а -1 — полное отличие.

#### 4. Дообучение модели на новых данных

Дообучение модели ResNet50 на новых данных включает следующие шаги:

1. **Изменение последнего слоя**: Последний fully connected слой заменяется на новый слой с одним выходом (для бинарной классификации).
2. **Замораживание весов**: Веса всех слоев, кроме последнего, замораживаются, чтобы предотвратить их изменение во время обучения.
3. **Обучение**: Модель обучается на новых данных с использованием функции потерь BCEWithLogitsLoss (бинарная кросс-энтропия с логитами) и оптимизатора Adam.

Математически процесс обучения включает:
- **Forward pass**: Входные данные проходят через сеть, и на выходе получаются предсказания.
- **Вычисление потерь**: Функция потерь сравнивает предсказания с истинными метками.
- **Backward pass**: Градиенты потерь распространяются обратно по сети, и веса обновляются с использованием оптимизатора.

### Преобразования данных между слоями и моделями

1. **YOLO**:
   - Вход: Изображение.
   - Выход: Координаты bounding box для обнаруженных логотипов.

2. **ResNet50**:
   - Вход: Обрезанное изображение логотипа.
   - Выход: Вектор признаков размерности 2048.

3. **Косинусное сходство**:
   - Вход: Два вектора признаков.
   - Выход: Значение сходства.

4. **Дообучение**:
   - Вход: Новые данные и метки.
   - Выход: Обновленная модель с улучшенной способностью классификации.

- **Система выводит результат** в виде бинарного ответа: "Да" (логотип принадлежит искомой организации) или "Нет" (логотип не принадлежит).



